"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,i){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,i){var s=_superPropBase(e,t);if(s){var n=Object.getOwnPropertyDescriptor(s,t);return n.get?n.get.call(i):n.value}})(e,t,i||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function o(a,r,h){function c(t,e){if(!r[t]){if(!a[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);var s=new Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}var n=r[t]={exports:{}};a[t][0].call(n.exports,function(e){return c(a[t][1][e]||e)},n,n.exports,o,a,r,h)}return r[t].exports}for(var l="function"==typeof require&&require,e=0;e<h.length;e++)c(h[e]);return c}({1:[function(e,t,i){var s="Cute Font",n=e("./lib/game");WebFont.load({google:{families:[s]},active:function(){new n(s,false)}})},{"./lib/game":2}],2:[function(e,t,i){var n=e("./scene/boot"),o=e("./scene/help"),a=e("./scene/play"),s=function(e){function s(e){var t,i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,s),i&&console.time("Game"),(t=_possibleConstructorReturn(this,_getPrototypeOf(s).call(this,{renderer:Phaser.AUTO,antialias:!0,backgroundColor:"#fcf1de",pixelArt:!1,roundPixels:!0,autoCenter:!0,banner:i,disableContextMenu:!i,scale:{mode:Phaser.Scale.RESIZE,parent:"game",width:window.innerWidth,height:window.innerHeight},scene:[n,o,a]}))).font=e,t.debug=i,t}return _inherits(s,Phaser.Game),_createClass(s,[{key:"start",value:function(){var e=this;_get(_getPrototypeOf(s.prototype),"start",this).call(this),document.querySelector("#game canvas").style.opacity=1,this.debug&&console.timeEnd("Game"),this.scale.on("resize",function(){document.querySelector("#game canvas").style.opacity=0,e.config.width=window.innerWidth,e.config.height=window.innerHeight,e.scene.getScene("Play").scene.stop(),e.scene.getScene("Help").scene.stop(),e.scene.getScene("Boot").scene.restart(),setTimeout(function(){document.querySelector("#game canvas").style.opacity=1},250)})}},{key:"sceneLog",value:function(e,t){this.debug&&(console.groupCollapsed("%cScene Log [".concat(e,"]"),"color: green;"),console.table(t),console.groupEnd())}}]),s}();t.exports=s},{"./scene/boot":9,"./scene/help":10,"./scene/play":11}],3:[function(e,t,i){var s=function(e){function i(e){var t;return _classCallCheck(this,i),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,e,0,.8*e.game.config.height,"bench"))).scene=e,t.setOrigin(0,.85).setScale(t.scene.game.device.os.desktop?.8:.6).setDepth(4),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(i,Phaser.GameObjects.Sprite),_createClass(i,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),i}();t.exports=s},{}],4:[function(e,t,i){var s=function(e){function o(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,s=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return _classCallCheck(this,o),(t=_possibleConstructorReturn(this,_getPrototypeOf(o).call(this,e,0,.8*e.game.config.height,"lamp-".concat(i,"-").concat(1==s?"on":"off")))).scene=e,t.gameCheck=!0,t.isCurrect=n,t.lightStatus=s,t.setOrigin(0,.96).setScale(t.scene.game.device.os.desktop?.8:.6).setDepth(4).setInteractive().on("pointerdown",function(){t.lightStatus=!t.lightStatus,t.setTexture("lamp-".concat(i,"-").concat(t.lightStatus?"on":"off"))},_assertThisInitialized(t)),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(o,Phaser.GameObjects.Sprite),_createClass(o,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),o}();t.exports=s},{}],5:[function(e,t,i){var v=e("./tree"),y=e("./pole"),w=e("./bench"),_=e("./lamp"),s=function(e){function i(e){var t;return _classCallCheck(this,i),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,e,0,0))).scene=e,t.level={requestCount:Math.round(e.game.config.width/180),keepResponse:[],data:[],current:1,score:0},t.scope={available:"three",one:{status:"active",keep:20,el:t.scene.add.container(t.scene.game.config.width+100,0)},two:{status:"active",keep:20,el:t.scene.add.container(2*t.scene.game.config.width+100,0)},three:{status:"pause",keep:20,el:t.scene.add.container(t.scene.game.config.width,0)}},t.area(t.scope.one.el,16711680),t.area(t.scope.two.el,65280),t.area(t.scope.three.el,255),t.add([t.scope.one.el,t.scope.two.el,t.scope.three.el]).setDepth(10),t.limit=-1*t.scene.game.config.width,t}return _inherits(i,Phaser.GameObjects.Container),_createClass(i,[{key:"show",value:function(){this.scene.add.existing(this),this.addContent(this.scope.one),this.addContent(this.scope.two)}},{key:"initRequest",value:function(){this.level.data=[];for(var e=1;e<=this.level.requestCount;e++)this.level.data.push(this.createRequest(this.level.current,e==this.level.requestCount||Phaser.Utils.Array.GetRandom([!0,!1])));this.level.current>(this.scene.game.device.os.desktop?2:4)&&this.scene.runSpace("mid"),this.level.current>(this.scene.game.device.os.desktop?5:8)&&this.scene.runSpace("max"),this.level.current++}},{key:"createRequest",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],i=Math.ceil(e/3),s={count:0,light:Phaser.Math.Between(0,i),pole:{status:8<=Phaser.Math.Between(1,12),more:0}};4<s.light&&(s.light=4),s.pole.status&&0<s.light&&s.light<=2&&(s.pole.more=Phaser.Utils.Array.GetRandom([-1,-2,1,2]),s.light+s.pole.more<0&&(s.pole.more=0)),s.count=s.light+s.pole.more;var n=[],o=[];if(2<=this.level.keepResponse.length&&(t=!0),t){for(var a in this.level.keepResponse)n.push(this.level.keepResponse[a]);this.level.keepResponse=[]}for(var r=s.count;0<r;){var h=1;1<r&&(h=2<=s.light?2:Phaser.Utils.Array.GetRandom([1,2])),n.push(h),r-=h}if(!t){for(var c in n)this.level.keepResponse.push(n[c]);n=[]}for(var l=0;l<n.length/2;l++)o.push(Phaser.Math.Between(1,2));return{request:s,currect:n,wrong:o}}},{key:"addContent",value:function(e){this.level.data.length||this.initRequest();var t=e.el.width*(this.scene.game.device.os.desktop?.8:.6),i=this.scene.add.container(0,0);for(e.el.add(i);e.keep<=t&&this.level.data.length;){var s=this.level.data.shift(),n=Phaser.Math.Between(10,30),o=new v(this.scene,Phaser.Math.Between(1,6),s.request.light).show().setX(e.keep+n);if(e.keep+=o.width+n,i.add(o),s.request.pole.status){var a=Phaser.Math.Between(5,15),r=new y(this.scene,s.request.pole.more).show().setX(e.keep+a);e.keep+=r.displayWidth+a,i.add(r)}else if(2==Phaser.Math.Between(1,2)){var h=Phaser.Math.Between(10,20),c=new w(this.scene).show().setX(e.keep+h);e.keep+=c.displayWidth+h,i.add(c)}var l=[];for(var p in s.currect){var u=Phaser.Math.Between(10,20),d=new _(this.scene,s.currect[p],Phaser.Utils.Array.GetRandom([!1,!0]),!0).show().setFlipX(1==s.currect[p]&&Phaser.Utils.Array.GetRandom([!1,!0])).setX(e.keep+u);e.keep+=d.displayWidth+u,l.push(d)}for(var g in s.wrong)if(e.keep<=t){var f=Phaser.Math.Between(10,20),m=new _(this.scene,s.wrong[g],Phaser.Utils.Array.GetRandom([!1,!0]),!1).show().setFlipX(1==s.currect[g]&&Phaser.Utils.Array.GetRandom([!1,!0])).setX(e.keep+f);e.keep+=m.displayWidth+f,l.push(m)}i.add(l)}i.x=(e.el.width-e.keep)/2}},{key:"removeContent",value:function(e){var t=this,i=!(e.status="pause");e.el.last.each(function(e){e.setAlpha(.3),e.gameCheck&&e.isCurrect!=e.lightStatus&&(e.setAlpha(1).setTintFill(16711680,0),i=!0)}),i?(this.scene.pauseSpace(),"active"==this.scope.one.status&&this.scene.tweens.add({targets:this.scope.one.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),"active"==this.scope.two.status&&this.scene.tweens.add({targets:this.scope.two.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),"active"==this.scope.three.status&&this.scene.tweens.add({targets:this.scope.three.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),this.scene.tweens.add({targets:e.el,x:0,delay:800,duration:800,ease:Phaser.Math.Easing.Back.Out}),this.scene.time.addEvent({delay:1e3,callback:function(){t.scene.title.setText("Game Over").setDepth(20).setTintFill(16711680,0)},callbackScope:this.scene}),this.scene.time.addEvent({delay:6e3,callback:function(){t.scene.scene.start("Boot")},callbackScope:this.scene})):(e.el.x=Math.abs(this.limit),e.el.removeAll(!0),e.keep=20)}},{key:"run",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;e&&(this.level.score+=e,"active"==this.scope.one.status&&(this.scope.one.el.x-=e,this.scope.one.el.x<=this.limit&&(this.scope.available="one",this.scope.three.status="active",this.removeContent(this.scope.one),this.addContent(this.scope.three))),"active"==this.scope.two.status&&(this.scope.two.el.x-=e,this.scope.two.el.x<=this.limit&&(this.scope.available="two",this.scope.one.status="active",this.removeContent(this.scope.two),this.addContent(this.scope.one))),"active"==this.scope.three.status&&(this.scope.three.el.x-=e,this.scope.three.el.x<=this.limit&&(this.scope.available="three",this.scope.two.status="active",this.removeContent(this.scope.three),this.addContent(this.scope.two))),this.scene.title.setText(Math.round(this.level.score/10).toString().padStart(5,"0")))}},{key:"area",value:function(e,t){return e.setSize(this.scene.game.config.width-40,.8*this.scene.game.config.height-40),this}}]),i}();t.exports=s},{"./bench":3,"./lamp":4,"./pole":6,"./tree":7}],6:[function(e,t,i){var s=function(e){function s(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"0";_classCallCheck(this,s);return(t=_possibleConstructorReturn(this,_getPrototypeOf(s).call(this,e,0,.8*e.game.config.height,"pole".concat({"-2":"-2","-1":"-1",0:"",1:"+1",2:"+2"}[i])))).scene=e,t.setOrigin(0,.97).setScale(t.scene.game.device.os.desktop?.8:.6).setDepth(4),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(s,Phaser.GameObjects.Sprite),_createClass(s,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),s}();t.exports=s},{}],7:[function(e,t,i){var s=function(e){function r(e){var t,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"1",s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e,0,.8*e.game.config.height))).scene=e;var n=t.scene.add.sprite(0,0,"tree".concat(i)).setScale(t.scene.game.device.os.desktop?.7:.5).setOrigin(0,.91);if(t.add(n),(s<0||4<s)&&(s=0),s){var o={w:200,h:230};switch(s){case 2:o.w*=2;break;case 3:o.w*=3;break;case 4:o.w*=2,o.h*=2}var a=t.scene.add.tileSprite(n.displayWidth/2,-1*n.displayHeight,o.w,o.h,"light").setScale(.13).setOrigin(.5,1);t.add(a)}return t.setDepth(4).setSize(n.displayWidth,n.displayHeight),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(r,Phaser.GameObjects.Container),_createClass(r,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),r}();t.exports=s},{}],8:[function(e,t,i){e("./gameObject/platform");var s=function(e){function i(e){var t;return _classCallCheck(this,i),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,e))).name=e,t.keepLog=[],t.lock=!0,t.helpOpen=!1,t}return _inherits(i,Phaser.Scene),_createClass(i,[{key:"log",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.game.debug&&e&&this.keepLog.push({message:e,bySystem:t}),this.keepLog}},{key:"init",value:function(){this.log("init",!0)}},{key:"preload",value:function(){this.log("preload",!0)}},{key:"create",value:function(){var e=this;this.ground=this.add.tileSprite(-2,this.game.config.height+2,this.game.config.width+4,.2*this.game.config.height,"ground").setOrigin(0,1).setTileScale(this.game.device.os.desktop?1:.6).setDepth(0),this.ground.speed={current:0,pause:0,min:this.game.device.os.desktop?2.5:2,mid:this.game.device.os.desktop?3.5:3,max:this.game.device.os.desktop?4.5:4},this.city=this.add.tileSprite(0,.8*this.game.config.height,this.game.config.width,109,"city").setOrigin(0,1).setDepth(1),this.city.speed={current:0,pause:0,min:.2,mid:.4,max:.6},this.line=this.add.graphics(0,0).fillStyle(16044610,1).fillRect(0,.8*this.game.config.height,this.game.config.width,3).setDepth(1),this.cloud=this.add.tileSprite(0,.6*this.game.config.height,this.game.config.width,105,"cloud").setOrigin(0,1).setDepth(2),this.cloud.speed={current:0,pause:0,min:-.4,mid:-.6,max:-.8},this.title=this.add.text(.5*this.game.config.width,.15*this.game.config.height,"",{font:"".concat(this.game.device.os.desktop?"160":"100","px '").concat(this.game.font,"'"),fill:"#FFF8EE"}).setOrigin(.5),this.helpBtn=this.add.text(25,this.game.config.height-20,"?",{font:"".concat(this.game.device.os.desktop?"40":"30","px '").concat(this.game.font,"'"),fill:"#FFF8EE"}).setOrigin(0,1).setInteractive().on("pointerdown",function(){e.helpOpen?e.scene.start("Boot"):e.scene.start("Help")},this),this.fullscreenBtn=this.add.text(this.game.config.width-25,this.game.config.height-20,"⎚",{font:"".concat(this.game.device.os.desktop?"40":"30","px '").concat(this.game.font,"'"),fill:"#FFF8EE"}).setOrigin(1,1).setInteractive().on("pointerdown",function(){e.scale.isFullscreen?e.scale.stopFullscreen():e.scale.startFullscreen()},this),this.log("create",!0),this.game.sceneLog(this.name,this.keepLog)}},{key:"update",value:function(){this.lock||(this.ground.speed.current&&(this.platform.run(this.ground.speed.current),this.ground.tilePositionX+=this.game.device.os.desktop?this.ground.speed.current:1.6*this.ground.speed.current,this.city.speed.current&&(this.city.tilePositionX+=this.city.speed.current)),this.cloud.speed.current&&(this.cloud.tilePositionX+=this.cloud.speed.current))}}]),i}();t.exports=s},{"./gameObject/platform":5}],9:[function(e,t,i){var s=e("../scene"),n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Boot"))}return _inherits(t,s),_createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"preload",value:function(){_get(_getPrototypeOf(t.prototype),"preload",this).call(this),this.load.image("ground","data/ground.png"),this.load.image("city","data/city.png"),this.load.image("cloud","data/cloud.png"),this.load.image("play","data/play.png"),this.load.image("help","data/help.png"),this.load.image("tree1","data/tree1.png"),this.load.image("tree2","data/tree2.png"),this.load.image("tree3","data/tree3.png"),this.load.image("tree4","data/tree4.png"),this.load.image("tree5","data/tree5.png"),this.load.image("tree6","data/tree6.png"),this.load.image("light","data/light.png"),this.load.image("bench","data/bench.png"),this.load.image("pole","data/pole.png"),this.load.image("pole-1","data/pole-1.png"),this.load.image("pole-2","data/pole-2.png"),this.load.image("pole+1","data/pole+1.png"),this.load.image("pole+2","data/pole+2.png"),this.load.image("lamp-1-on","data/lamp-1-on.png"),this.load.image("lamp-1-off","data/lamp-1-off.png"),this.load.image("lamp-2-on","data/lamp-2-on.png"),this.load.image("lamp-2-off","data/lamp-2-off.png")}},{key:"create",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"create",this).call(this),this.load.audio("music","data/music.mp3").on("filecomplete",function(){e.sound.add("music",{volume:1,loop:!0}).play()}).start(),this.helpOpen=!1,this.game.config.height>this.game.config.width?(this.title.setText("Rotate!").setDepth(20).setTintFill(16711680,0).setPosition(this.game.config.width/2,.8*this.game.config.height/2),this.tweens.add({targets:this.title,scale:{from:.95,to:1.05},duration:150,yoyo:!0,repeat:-1})):this.game.config.width<480||this.game.config.height<320?(this.title.setText("Screen!").setDepth(20).setTintFill(16711680,0).setPosition(this.game.config.width/2,.8*this.game.config.height/2),this.tweens.add({targets:this.title,scale:{from:.95,to:1.05},duration:150,yoyo:!0,repeat:-1})):(this.title.setText("Light Tree").setTintFill(16044610),this.btn=this.add.sprite(0,0,"play").setOrigin(.5).setPosition(this.game.config.width/2,this.game.config.height/2+.1*this.game.config.height).setDepth(10).setScale(.3).setInteractive().on("pointerdown",function(){e.scene.start("Play")},this),this.tweens.add({targets:this.btn,x:{from:.497*this.game.config.width,to:.503*this.game.config.width},duration:300,yoyo:!0,repeat:-1}))}}]),t}();t.exports=n},{"../scene":8}],10:[function(e,t,i){var s=e("../scene"),n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Help"))}return _inherits(t,s),_createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"preload",value:function(){_get(_getPrototypeOf(t.prototype),"preload",this).call(this)}},{key:"create",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"create",this).call(this),this.ground.setVisible(!1),this.city.setVisible(!1),this.cloud.setVisible(!1),this.line.setVisible(!1),this.fullscreenBtn.setVisible(!1),this.helpImage=this.add.image(0,0,"help").setOrigin(.5).setScale(this.game.device.os.desktop?.6:.4).setDepth(5).setPosition(this.game.config.width/2,this.game.config.height/2).setInteractive().on("pointerdown",function(){e.scene.start("Boot")},this),this.helpOpen=!0,this.helpBtn.setText("«").setTintFill(0)}}]),t}();t.exports=n},{"../scene":8}],11:[function(e,t,i){var s=e("../scene"),n=e("../gameObject/platform"),o=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Play"))).lock=!1,e}return _inherits(t,s),_createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"preload",value:function(){_get(_getPrototypeOf(t.prototype),"preload",this).call(this)}},{key:"create",value:function(){_get(_getPrototypeOf(t.prototype),"create",this).call(this),this.lock=!1,this.helpOpen=!1,this.platform=new n(this),this.game.config.height>this.game.config.width?(this.title.setText("Rotate!"),this.tweens.add({targets:this.title,angle:{from:-5,to:5},duration:150,yoyo:!0,repeat:-1})):this.game.config.width<480||this.game.config.height<320?(this.title.setText("Screen!"),this.tweens.add({targets:this.title,y:50,duration:150,yoyo:!0,repeat:-1})):(this.platform.show(),this.runSpace())}},{key:"runSpace",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"min",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];for(var i in t.length||(t=["ground","city","cloud"]),t)this[t[i]].speed.current=this[t[i]].speed[e]}},{key:"pauseSpace",value:function(){this.lock=!0,this.ground.speed.current=this.ground.speed.pause,this.city.speed.current=this.city.speed.pause,this.cloud.speed.current=this.cloud.speed.pause}}]),t}();t.exports=o},{"../gameObject/platform":5,"../scene":8}]},{},[1]);