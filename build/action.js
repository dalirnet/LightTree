"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var s=0;s<t.length;s++){var i=t[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,s){return t&&_defineProperties(e.prototype,t),s&&_defineProperties(e,s),e}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _get(e,t,s){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,s){var i=_superPropBase(e,t);if(i){var n=Object.getOwnPropertyDescriptor(i,t);return n.get?n.get.call(s):n.value}})(e,t,s||e)}function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}!function o(a,r,c){function h(t,e){if(!r[t]){if(!a[t]){var s="function"==typeof require&&require;if(!e&&s)return s(t,!0);if(l)return l(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=r[t]={exports:{}};a[t][0].call(n.exports,function(e){return h(a[t][1][e]||e)},n,n.exports,o,a,r,c)}return r[t].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)h(c[e]);return h}({1:[function(e,t,s){var i="Cute Font",n=e("./lib/game");WebFont.load({google:{families:[i]},active:function(){new n(i,false)}})},{"./lib/game":2}],2:[function(e,t,s){var n=e("./scene/boot"),o=e("./scene/play"),i=function(e){function i(e){var t,s=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return _classCallCheck(this,i),s&&console.time("Game"),(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,{renderer:Phaser.AUTO,antialias:!0,backgroundColor:"#fcf1de",pixelArt:!1,roundPixels:!0,autoCenter:!0,banner:s,disableContextMenu:!s,scale:{mode:Phaser.Scale.RESIZE,parent:"game",width:window.innerWidth,height:window.innerHeight},scene:[n,o]}))).font=e,t.debug=s,t}return _inherits(i,Phaser.Game),_createClass(i,[{key:"start",value:function(){_get(_getPrototypeOf(i.prototype),"start",this).call(this),document.querySelector("#game canvas").style.opacity=1,this.debug&&console.timeEnd("Game"),this.scale.on("resize",function(){document.querySelector("#game canvas").style.opacity=0,window.location.reload()})}},{key:"sceneLog",value:function(e,t){this.debug&&(console.groupCollapsed("%cScene Log [".concat(e,"]"),"color: green;"),console.table(t),console.groupEnd())}}]),i}();t.exports=i},{"./scene/boot":9,"./scene/play":10}],3:[function(e,t,s){var i=function(e){function s(e){var t;return _classCallCheck(this,s),(t=_possibleConstructorReturn(this,_getPrototypeOf(s).call(this,e,0,.8*e.game.config.height,"bench"))).scene=e,t.setOrigin(0,.92).setScale(.8).setDepth(4),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(s,Phaser.GameObjects.Sprite),_createClass(s,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),s}();t.exports=i},{}],4:[function(e,t,s){var i=function(e){function o(e){var t,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2,i=2<arguments.length&&void 0!==arguments[2]&&arguments[2],n=!(3<arguments.length&&void 0!==arguments[3])||arguments[3];return _classCallCheck(this,o),(t=_possibleConstructorReturn(this,_getPrototypeOf(o).call(this,e,0,.8*e.game.config.height,"lamp-".concat(s,"-").concat(1==i?"on":"off")))).scene=e,t.gameCheck=!0,t.isCurrect=n,t.lightStatus=i,t.setOrigin(0,.98).setScale(.8).setDepth(4).setInteractive().on("pointerdown",function(){t.lightStatus=!t.lightStatus,t.setTexture("lamp-".concat(s,"-").concat(t.lightStatus?"on":"off"))},_assertThisInitialized(t)),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(o,Phaser.GameObjects.Sprite),_createClass(o,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),o}();t.exports=i},{}],5:[function(e,t,s){var v=e("./tree"),y=e("./pole"),w=e("./bench"),_=e("./lamp"),i=function(e){function s(e){var t;return _classCallCheck(this,s),(t=_possibleConstructorReturn(this,_getPrototypeOf(s).call(this,e,0,0))).scene=e,t.level={requestCount:Math.round(e.game.config.width/180),keepResponse:[],data:[],current:1,score:0},t.scope={available:"three",one:{status:"active",keep:20,el:t.scene.add.container(t.scene.game.config.width+100,0)},two:{status:"active",keep:20,el:t.scene.add.container(2*t.scene.game.config.width+100,0)},three:{status:"pause",keep:20,el:t.scene.add.container(t.scene.game.config.width,0)}},t.area(t.scope.one.el,16711680),t.area(t.scope.two.el,65280),t.area(t.scope.three.el,255),t.add([t.scope.one.el,t.scope.two.el,t.scope.three.el]).setDepth(10),t.limit=-1*t.scene.game.config.width,t}return _inherits(s,Phaser.GameObjects.Container),_createClass(s,[{key:"show",value:function(){this.scene.add.existing(this),this.addContent(this.scope.one),this.addContent(this.scope.two)}},{key:"initRequest",value:function(){this.level.data=[];for(var e=1;e<=this.level.requestCount;e++)this.level.data.push(this.createRequest(this.level.current,e==this.level.requestCount||Phaser.Utils.Array.GetRandom([!0,!1])));this.level.current>(this.scene.game.device.os.desktop?2:4)&&this.scene.runSpace("mid"),this.level.current>(this.scene.game.device.os.desktop?5:10)&&this.scene.runSpace("max"),this.level.current++}},{key:"createRequest",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],s=Math.ceil(e/3),i={count:0,light:Phaser.Math.Between(0,s),pole:{status:8<=Phaser.Math.Between(1,12),more:0}};4<i.light&&(i.light=4),i.pole.status&&0<i.light&&i.light<=2&&(i.pole.more=Phaser.Utils.Array.GetRandom([-1,-2,1,2]),i.light+i.pole.more<0&&(i.pole.more=0)),i.count=i.light+i.pole.more;var n=[],o=[];if(2<=this.level.keepResponse.length&&(t=!0),t){for(var a in this.level.keepResponse)n.push(this.level.keepResponse[a]);this.level.keepResponse=[]}for(var r=i.count;0<r;){var c=1;1<r&&(c=2<=i.light?2:Phaser.Utils.Array.GetRandom([1,2])),n.push(c),r-=c}if(!t){for(var h in n)this.level.keepResponse.push(n[h]);n=[]}for(var l=0;l<n.length/2;l++)o.push(Phaser.Math.Between(1,2));return{request:i,currect:n,wrong:o}}},{key:"addContent",value:function(e){this.level.data.length||this.initRequest();var t=e.el.width*(this.scene.game.device.os.desktop?.8:.6),s=this.scene.add.container(0,0);for(e.el.add(s);e.keep<=t&&this.level.data.length;){var i=this.level.data.shift(),n=Phaser.Math.Between(10,30),o=new v(this.scene,Phaser.Math.Between(1,6),i.request.light).show().setX(e.keep+n);if(e.keep+=o.width+n,s.add(o),i.request.pole.status){var a=Phaser.Math.Between(5,15),r=new y(this.scene,i.request.pole.more).show().setX(e.keep+a);e.keep+=r.displayWidth+a,s.add(r)}else if(2==Phaser.Math.Between(1,2)){var c=Phaser.Math.Between(10,20),h=new w(this.scene).show().setX(e.keep+c);e.keep+=h.displayWidth+c,s.add(h)}var l=[];for(var u in i.currect){var p=Phaser.Math.Between(10,20),d=new _(this.scene,i.currect[u],Phaser.Utils.Array.GetRandom([!1,!0]),!0).show().setFlipX(1==i.currect[u]&&Phaser.Utils.Array.GetRandom([!1,!0])).setX(e.keep+p);e.keep+=d.displayWidth+p,l.push(d)}for(var g in i.wrong)if(e.keep<=t){var f=Phaser.Math.Between(10,20),m=new _(this.scene,i.wrong[g],Phaser.Utils.Array.GetRandom([!1,!0]),!1).show().setFlipX(1==i.currect[g]&&Phaser.Utils.Array.GetRandom([!1,!0])).setX(e.keep+f);e.keep+=m.displayWidth+f,l.push(m)}s.add(l)}s.x=(e.el.width-e.keep)/2}},{key:"removeContent",value:function(e){var t=this,s=!(e.status="pause");e.el.last.each(function(e){e.setAlpha(.3),e.gameCheck&&e.isCurrect!=e.lightStatus&&(e.setAlpha(1).setTintFill(16711680,0),s=!0)}),s?(this.scene.pauseSpace(),"active"==this.scope.one.status&&this.scene.tweens.add({targets:this.scope.one.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),"active"==this.scope.two.status&&this.scene.tweens.add({targets:this.scope.two.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),"active"==this.scope.three.status&&this.scene.tweens.add({targets:this.scope.three.el,x:1.2*this.scene.game.config.width,duration:800,ease:Phaser.Math.Easing.Back.In}),this.scene.tweens.add({targets:e.el,x:0,delay:800,duration:800,ease:Phaser.Math.Easing.Back.Out}),this.scene.time.addEvent({delay:1e3,callback:function(){t.scene.title.setText("Game Over").setDepth(20).setTintFill(16711680,0)},callbackScope:this.scene}),this.scene.time.addEvent({delay:6e3,callback:function(){t.scene.scene.start("Boot")},callbackScope:this.scene})):(e.el.x=Math.abs(this.limit),e.el.removeAll(!0),e.keep=20)}},{key:"run",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;e&&(this.level.score+=e,"active"==this.scope.one.status&&(this.scope.one.el.x-=e,this.scope.one.el.x<=this.limit&&(this.scope.available="one",this.scope.three.status="active",this.removeContent(this.scope.one),this.addContent(this.scope.three))),"active"==this.scope.two.status&&(this.scope.two.el.x-=e,this.scope.two.el.x<=this.limit&&(this.scope.available="two",this.scope.one.status="active",this.removeContent(this.scope.two),this.addContent(this.scope.one))),"active"==this.scope.three.status&&(this.scope.three.el.x-=e,this.scope.three.el.x<=this.limit&&(this.scope.available="three",this.scope.two.status="active",this.removeContent(this.scope.three),this.addContent(this.scope.two))),this.scene.title.setText(Math.round(this.level.score/10).toString().padStart(5,"0")))}},{key:"area",value:function(e,t){return e.setSize(this.scene.game.config.width-40,.8*this.scene.game.config.height-40),this}}]),s}();t.exports=i},{"./bench":3,"./lamp":4,"./pole":6,"./tree":7}],6:[function(e,t,s){var i=function(e){function i(e){var t,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"0";_classCallCheck(this,i);return(t=_possibleConstructorReturn(this,_getPrototypeOf(i).call(this,e,0,.8*e.game.config.height,"pole".concat({"-2":"-2","-1":"-1",0:"",1:"+1",2:"+2"}[s])))).scene=e,t.setOrigin(0,.98).setScale(.8).setDepth(4),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(i,Phaser.GameObjects.Sprite),_createClass(i,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),i}();t.exports=i},{}],7:[function(e,t,s){var i=function(e){function r(e){var t,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"1",i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;_classCallCheck(this,r),(t=_possibleConstructorReturn(this,_getPrototypeOf(r).call(this,e,0,.8*e.game.config.height))).scene=e;var n=t.scene.add.sprite(0,0,"tree".concat(s)).setScale(.7).setOrigin(0,.92);if(t.add(n),(i<0||4<i)&&(i=0),i){var o={w:200,h:230};switch(i){case 2:o.w*=2;break;case 3:o.w*=3;break;case 4:o.w*=2,o.h*=2}var a=t.scene.add.tileSprite(n.displayWidth/2,-1*n.displayHeight,o.w,o.h,"light").setScale(.13).setOrigin(.5,1);t.add(a)}return t.setDepth(4).setSize(n.displayWidth,n.displayHeight),_possibleConstructorReturn(t,_assertThisInitialized(t))}return _inherits(r,Phaser.GameObjects.Container),_createClass(r,[{key:"show",value:function(){return this.scene.add.existing(this),this}}]),r}();t.exports=i},{}],8:[function(e,t,s){e("./gameObject/platform");var i=function(e){function s(e){var t;return _classCallCheck(this,s),(t=_possibleConstructorReturn(this,_getPrototypeOf(s).call(this,e))).name=e,t.keepLog=[],t.lock=!0,t}return _inherits(s,Phaser.Scene),_createClass(s,[{key:"log",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:null,t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.game.debug&&e&&this.keepLog.push({message:e,bySystem:t}),this.keepLog}},{key:"init",value:function(){this.log("init",!0)}},{key:"preload",value:function(){this.log("preload",!0)}},{key:"create",value:function(){this.ground=this.add.tileSprite(-2,this.game.config.height+2,this.game.config.width+4,.2*this.game.config.height,"ground").setOrigin(0,1).setTileScale(this.game.device.os.desktop?1:.6).setDepth(0),this.ground.speed={current:0,pause:0,min:2,mid:3,max:4},this.city=this.add.tileSprite(0,.8*this.game.config.height,this.game.config.width,109,"city").setOrigin(0,1).setDepth(1),this.city.speed={current:0,pause:0,min:.2,mid:.4,max:.6},this.line=this.add.graphics(0,0).fillStyle(16044610,1).fillRect(0,.8*this.game.config.height,this.game.config.width,3).setDepth(1),this.cloud=this.add.tileSprite(0,.6*this.game.config.height,this.game.config.width,105,"cloud").setOrigin(0,1).setDepth(2),this.cloud.speed={current:0,pause:0,min:-.4,mid:-.6,max:-.8},this.title=this.add.text(.5*this.game.config.width,.15*this.game.config.height,"",{font:"".concat(this.game.device.os.desktop?"160":"100","px '").concat(this.game.font,"'"),fill:"#FFF8EE"}).setOrigin(.5),this.log("create",!0),this.game.sceneLog(this.name,this.keepLog)}},{key:"update",value:function(){this.lock||(this.ground.speed.current&&(this.platform.run(this.ground.speed.current),this.ground.tilePositionX+=this.game.device.os.desktop?this.ground.speed.current:1.6*this.ground.speed.current,this.city.speed.current&&(this.city.tilePositionX+=this.city.speed.current)),this.cloud.speed.current&&(this.cloud.tilePositionX+=this.cloud.speed.current))}}]),s}();t.exports=i},{"./gameObject/platform":5}],9:[function(e,t,s){var i=e("../scene"),n=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Boot"))}return _inherits(t,i),_createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"preload",value:function(){_get(_getPrototypeOf(t.prototype),"preload",this).call(this),this.load.image("ground","data/ground.png"),this.load.image("city","data/city.png"),this.load.image("cloud","data/cloud.png"),this.load.image("play","data/play.png"),this.load.image("tree1","data/tree1.png"),this.load.image("tree2","data/tree2.png"),this.load.image("tree3","data/tree3.png"),this.load.image("tree4","data/tree4.png"),this.load.image("tree5","data/tree5.png"),this.load.image("tree6","data/tree6.png"),this.load.image("light","data/light.png"),this.load.image("bench","data/bench.png"),this.load.image("pole","data/pole.png"),this.load.image("pole-1","data/pole-1.png"),this.load.image("pole-2","data/pole-2.png"),this.load.image("pole+1","data/pole+1.png"),this.load.image("pole+2","data/pole+2.png"),this.load.image("lamp-1-on","data/lamp-1-on.png"),this.load.image("lamp-1-off","data/lamp-1-off.png"),this.load.image("lamp-2-on","data/lamp-2-on.png"),this.load.image("lamp-2-off","data/lamp-2-off.png")}},{key:"create",value:function(){var e=this;_get(_getPrototypeOf(t.prototype),"create",this).call(this),this.title.setText("Light Tree"),this.btn=this.add.sprite(0,0,"play").setOrigin(.5).setPosition(this.game.config.width/2,this.game.config.height/2).setDepth(10).setScale(.4).setInteractive().on("pointerdown",function(){e.scene.start("Play")},this),this.tweens.add({targets:this.btn,x:{from:.495*this.game.config.width,to:.505*this.game.config.width},duration:300,yoyo:!0,repeat:-1})}}]),t}();t.exports=n},{"../scene":8}],10:[function(e,t,s){var i=e("../scene"),n=e("../gameObject/platform"),o=function(e){function t(){var e;return _classCallCheck(this,t),(e=_possibleConstructorReturn(this,_getPrototypeOf(t).call(this,"Play"))).lock=!1,e}return _inherits(t,i),_createClass(t,[{key:"init",value:function(){_get(_getPrototypeOf(t.prototype),"init",this).call(this)}},{key:"preload",value:function(){_get(_getPrototypeOf(t.prototype),"preload",this).call(this)}},{key:"create",value:function(){_get(_getPrototypeOf(t.prototype),"create",this).call(this),this.lock=!1,this.platform=new n(this),this.game.config.height>this.game.config.width?(this.title.setText("Rotate!"),this.tweens.add({targets:this.title,angle:{from:-5,to:5},duration:150,yoyo:!0,repeat:-1})):this.game.config.width<480||this.game.config.height<320?(this.title.setText("Screen!"),this.tweens.add({targets:this.title,y:50,duration:150,yoyo:!0,repeat:-1})):(this.platform.show(),this.runSpace())}},{key:"runSpace",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"min",t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];for(var s in t.length||(t=["ground","city","cloud"]),t)this[t[s]].speed.current=this[t[s]].speed[e]}},{key:"pauseSpace",value:function(){this.lock=!0,this.ground.speed.current=this.ground.speed.pause,this.city.speed.current=this.city.speed.pause,this.cloud.speed.current=this.cloud.speed.pause}}]),t}();t.exports=o},{"../gameObject/platform":5,"../scene":8}]},{},[1]);